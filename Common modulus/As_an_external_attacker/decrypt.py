from Crypto.Util.number import long_to_bytes as ltb, bytes_to_long as btl
import gmpy2

def extended_euclid_gcd(a, b):
    
    s = 0; old_s = 1
    t = 1; old_t = 0
    r = b; old_r = a

    while r != 0:
        quotient = old_r//r 
        old_r, r = r, old_r - quotient*r
        old_s, s = s, old_s - quotient*s
        old_t, t = t, old_t - quotient*t
    return [old_r, old_s, old_t]
"""
n = 866578339778986007642014384108618649836491928404285620131419151770709154355301311933184033210968800872008599831319095359726298770209847334496763418659422076154401497704653540634372117475306413477493637353380803946324372876675326337142542335889584048561272790438399758986470991940268970267894024466756987402461532314183196905526260889071183304623437342439989892466638388463563901889394479406077700134439500307250355153674639026247616396112831248678258056522259015843402897044106846282981066407169397181166430403212552269284790604628447385399589396816000556288297420701484448022111541236011603479797145522579410980771864990146667864947163780735520078333683968426213081245838863803250669349679767946088453183711261230458105284311556460656153282378315329164804617904572633440700814233663318897971131665162386056957710673061676912082367030328088269023189935064163533502973806650193868182283156830590844340111882268180248222786505883625874904262177764531359450429152365143389161723021961363835702623851644709124114911605165035363567948704179405324299917303369726668627682330375224227392445283716920858281138254070297685969471943438744331832154468397863921724828620558561740698024610026272284486627184648481984084343459915022041975729100879
e1 = 16385
e2 = 65537
c1 = 32907950036683256784010089047630971012200374032745541490496970724586174183970193639551364128119659782685576117314242302848003180999101855726397749077973880547125294994371132282252105925478193959483930634385229086602708272215276580326646923669099801641570608899162437086906630396964858225172298035583621153115157397799240230135898717492584088242520437539513103229167320810425088636838256835139752443633848336296048269218207598314144394412246980373459740141365560339238988344805503709606342018934992092917371289918681010809730003058479326334142141046781430464523787409155691132995478657610189577514439242476562967888826397524879394197157301747024916360982232080002457193898125525865800928180002208531698989452330373721385378104100952143050220947251871458748896391379922333289832955090749350735644962906612994363771295369054259564680426752734127625082221065170835832777199275367338384701964889437630754115104602808266944727177288044636382091494415540259666372020123089047577122725959209648384391926947866911095738109024898218195618964698773679125327625956427681454464447683759925657478426261782380493873541121595137335909085568197850119121530043354551896519419070749007899014203735051089050767887111376712345263867853276756857502709516
c2 = 792954090216858749341545294628346311459282308277768006466111328890295089579807080286365842620159881956920715300939754189116911442889376999441715744964987103260996524472167219056389144882439381698655898359490461499176402896999543868722776876617451766225597379488987566903925335565356805416992116698579795377717911881377291129798025251312334818390161243172331935691693302124948920566471331612927997531258945721791220988690600425869787769319628736295706291071450155107151257227174055800882576190021654341005318545252404535840331460289705706072409025767880012606301655929640223385306262552155548008551491678554258058672147520675121804822905242611997870725113475176884849463521214593545774443209475590992711509616926983886895694372723459812209768070866559533042109627444119743865202640087335642950846792509540218665420597062764620516625010182273606296258412375020733809734758821645754921096618055176880761397715521223877653980260835511484951827588625213622533791480141206233959145704707574437046320350430082718759392432010103444440706236087379748968462609154319053952888083263812828422293467923018171838348829091166044159121353425127480496515515354961696532592043951274233295648658317345816140734867623133628907990159133372928355747054774
"""
n = 384551944731400036381810776767496661829658752693711118715285724516754898572022813584490815475287507985082097114052364994067026603408735473782926372983617830571992342318755370118285903055284159581935977331832377995677004276029990202222680861544195566359332551354253348663851032455431172511259672410803916378836808447382614507738042338951402035854719734928804454492727441259067631764072994337258154098311090326420857966731340343919943105753300416498911557025995122420137392750720974133165801380569737730211032074565317742316872282570825212101297592064692991234274832588588789468274476881983540937956375131115544822470211889420528295212136115217186621258146606169465309827602963586860875448120368211678689900889765241527974595474805928316015375274352722697316401936222041162460767257558624148121047909398798001310484773307323079894014532279993952247459155937518105178285724283870292821536131572116898348322187415388681702968912949561340145242682333784749139651176671331901150336426664408798661371543833950415689007225407894040012807723551329108119499443733430291655681183822428525891869138447827302511992609610706631294856174706010673176608220434607142488669594494388460607963476808925014310542543394214330451323862142290373003148503527
e1 = 49155
e2 = 196611
c1 = 334623988827618993598782894733002241797530576094571458990300053870668795985232787359108188695781479273018640216862673356572803943586960866046010993766742101660728680781397015002894875788497246449809441822665493699543524715601842455564473643870082385920768860619872162686327617273810269681717705815011682729907135686145954961627937177199907518771185469540563318025263602500062807912163052413474635831185905662591539240485606723203304928941341085233231554787287748288107870466769027958588583204141805649983574995723709849171755853852231462065048772726960047109944214677313786078499887540505853617592163042818725194018162452598260884302346562838127576315174305048979100123367966565051250613648852437906109002327513611982707197807506459642123878905726926774277964860226783054888606100422989203547078299778230364639525504769684083498419378626089263650989231700073711044831313019919812042535775766920668503708055772222001232614101747267994313783070256993549281079448912234811563611727264543558120826318478947461476129436847535907013700909936906857648530733161167759413424356597334019692606189169406911072127095517298350442809239408976314412860566198773430105449057268123091266046424722242158314361208574429486836703942513182133567680571771
c2 = 363885559993585822543801840244273543021862566951306692537667765468164957290130874104337355444770910105061415135309430175080226207326234080733060582073689705741981284460762108259628568458675650925819154374802775657409234796090824940062488165845795808163423738506664593859678866321632957834417314984366758032226301361999669608376096304354965863244865989968401359611567940657092706287487631528296571002262796906173755675645748176291242614105627240193197179298635414980434142908243033558790113623842783837313292400324985845954743812042372133207621424502810800126416489777531717173103538306432900552998798541613286980095262508284501724082634286696886952309766491916097877098465111634758057577077986339081371383227619361616270428044672164534118946223202039013343614057066882726500873403845045454217750559366711799441778113968063202694691469677887355171927675673781741874409425545050643626693694440881703048146753608635159236376324231373099863351097356323515161749532517868601051940939915401370947654603550836395452344675408659818553688647058324579663590902956888989927091701473635293094402441410332606150017739832578967916505735835738753864069292998009725937895488469013727062143909687886170690252564727041662186277819357007866091557558487

gcd, x, y = extended_euclid_gcd(e1, e2)
print(gcd)
m = (pow(c1, x, n) * pow(c2, y, n)) % n
print(ltb(gmpy2.iroot(m,3)[0]))
